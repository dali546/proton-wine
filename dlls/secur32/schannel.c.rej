--- dlls/secur32/schannel.c
+++ dlls/secur32/schannel.c
@@ -734,7 +734,7 @@ static SECURITY_STATUS SEC_ENTRY schan_InitializeSecurityContextW(
             return SEC_E_INSUFFICIENT_MEMORY;
     }
 
-    if (!phContext)
+    if (!phContext || (phNewContext && !pInput))
     {
         ULONG_PTR handle;
         struct create_session_params create_params;
